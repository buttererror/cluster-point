(function(t){function e(e){for(var i,s,a=e[0],u=e[1],c=e[2],d=0,p=[];d<a.length;d++)s=a[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&p.push(o[s][0]),o[s]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(t[i]=u[i]);l&&l(e);while(p.length)p.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],i=!0,a=1;a<n.length;a++){var u=n[a];0!==o[u]&&(i=!1)}i&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var i={},o={app:0},r=[];function s(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=i,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/cluster-point/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var l=u;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"1c5c":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("layout")],1)},r=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"layout"},[n("sidebar"),t.isMap?n("google-map"):t._e()],1)},a=[],u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"sidebar",class:{closed:t.canToggleSidebar}},[n("div",{staticClass:"sidebar-title"},[n("div",{staticClass:"space"}),n("div",[n("h1",[t._v(" Groups ")]),t.canToggleSidebar?n("button",{on:{click:t.toggleSidebar}},[t.isSidebarOpened?n("span",[t._v("Close")]):n("span",[t._v("Open")])]):t._e()])]),n("div",{staticClass:"sidebar-content"},[t._l(t.groups,(function(e){return n("div",{key:e.id,staticClass:"group"},[n("div",{staticClass:"group-title",on:{click:function(n){return t.changePolygonColor(e)}}},[n("div",{staticClass:"space"}),n("input",{attrs:{type:"color",id:e.id,disabled:""},domProps:{value:e.color}}),n("label",{staticClass:"pointer",attrs:{for:e.id}},[t._v("Group")])]),t._l(e.points,(function(e){return n("div",{key:e.id,staticClass:"group-item"},[n("div",{staticClass:"space"}),n("div",{staticClass:"space"}),t.isEditingPointName[e.id]?n("form-input",{staticClass:"point-input",attrs:{"data-point-id":e.id},on:{blur:function(n){return t.$set(t.isEditingPointName,e.id,!1)},enter:function(n){return t.$set(t.isEditingPointName,e.id,!1)}},model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"point.name"}}):n("span",{staticClass:"point-name",attrs:{"data-point-id":e.id},on:{click:t.enterEditMode}},[t._v(t._s(e.name))]),n("span",{staticClass:"point-coordinates"},[t._v(t._s(e.marker.getPosition().lat().toFixed(3))+"; "+t._s(e.marker.getPosition().lng().toFixed(3)))])],1)}))],2)})),t.hasUngroupedPoints?n("div",{staticClass:"group"},[t._m(0),t._l(t.ungroupedPoints,(function(e){return n("div",{key:e.id,staticClass:"group-item"},[n("div",{staticClass:"space"}),n("div",{staticClass:"space"}),t.isEditingPointName[e.id]?n("form-input",{staticClass:"point-input",attrs:{"data-point-id":e.id},on:{blur:function(n){return t.$set(t.isEditingPointName,e.id,!1)},enter:function(n){return t.$set(t.isEditingPointName,e.id,!1)}},model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"point.name"}}):n("span",{staticClass:"point-name",attrs:{"data-point-id":e.id},on:{click:t.enterEditMode}},[t._v(t._s(e.name))]),n("span",{staticClass:"point-coordinates"},[t._v(t._s(e.marker.getPosition().lat().toFixed(3))+"; "+t._s(e.marker.getPosition().lng().toFixed(3)))])],1)}))],2):t._e()],2),n("div",{staticClass:"sidebar-footer"},[n("div",{staticClass:"space"}),n("button",{on:{click:t.clearMap}},[t._v("Clear points")])])])},c=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"group-title"},[n("div",{staticClass:"space"}),n("div",{staticClass:"space"}),n("label",[t._v("ungrouped")])])}],l=n("b85c"),d=(n("07ac"),n("d81d"),new i["a"]),p=n("d4ec"),h=n("bee2"),g=n("4143"),f=n("d5e4"),m=n("ade3"),v=n("5364"),b=n("34d8"),y=(n("b0c0"),n("d3b7"),n("3ca3"),n("10d1"),n("ddb0"),n("1fe2"),new WeakMap),P=new WeakSet,C=function(){function t(e,n){Object(p["a"])(this,t),Object(g["a"])(this,P),Object(m["a"])(this,"id",null),Object(m["a"])(this,"marker",null),Object(m["a"])(this,"name",null),Object(m["a"])(this,"group",null),Object(f["a"])(this,y,{writable:!0,value:["Thor","Loki","Iron Man","Doctor Strange","Spider Man","Captain America","Batman","Cat woman"]}),this.id=e,this.marker=n,this.name=Object(b["a"])(this,P,O).call(this)}return Object(h["a"])(t,[{key:"isInGroup",value:function(){return null!==this.group}},{key:"isInSameGroup",value:function(t){return!(!this.group||!t.group)&&this.group.name===t.group.name}}],[{key:"generatePointId",value:function(t){return t.length}},{key:"changeShapeColor",value:function(t){return this.shape.strokeColor=t,this.shape}}]),t}();function O(){return Object(v["a"])(this,y)[Math.floor(Math.random()*Object(v["a"])(this,y).length)]}Object(m["a"])(C,"shape",{path:google.maps.SymbolPath.CIRCLE,fillColor:"white",fillOpacity:1,strokeWeight:4,rotation:0,scale:5});var k=C,w=(n("25f0"),n("caad"),n("2532"),function(){function t(e,n,i,o){Object(p["a"])(this,t),Object(m["a"])(this,"points",[]),Object(m["a"])(this,"id",null),Object(m["a"])(this,"color",null),Object(m["a"])(this,"name",null),Object(m["a"])(this,"polygon",null),this.name="g"+i,this.id=i,this.addPoint(e),this.addPoint(n),this.color=o}return Object(h["a"])(t,[{key:"addPoint",value:function(t){t.group=this,this.points.push(t)}},{key:"concatGroup",value:function(t){var e,n=Object(l["a"])(t.points);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.addPoint(i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"drawPolygon",value:function(t){var e=this,n=this.points.map((function(t){return t.marker.setIcon(k.changeShapeColor(e.color)),t=t.marker.getPosition(),t})),i=new google.maps.Polygon({strokeColor:this.color,strokeOpacity:1,strokeWeight:2,fillColor:this.color,fillOpacity:.35});this.polygon=i,i.setMap(t),i.setPaths(n)}}],[{key:"generateUniqueColor",value:function(t){var e=Math.floor(16777215*Math.random()).toString(16);return t.includes(e)&&this.generateUniqueColor(t),"#"+e}}]),t}()),_=w,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",{attrs:{type:"text"},domProps:{value:t.value},on:{input:t.update,blur:function(e){return t.$emit("blur")},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$emit("enter")}}})},S=[],M={name:"FormInput",props:{value:{type:String}},methods:{update:function(t){this.$emit("input",t.target.value)}}},x=M,$=n("2877"),G=Object($["a"])(x,j,S,!1,null,"6dda4b5d",null),I=G.exports,E={name:"Sidebar",components:{FormInput:I},data:function(){return{groups:[],ungroupedPoints:[],windowWidth:0,isSidebarOpened:!1,isEditingPointName:{}}},computed:{hasUngroupedPoints:function(){return!!Object.values(this.ungroupedPoints).length},canToggleSidebar:function(){return this.windowWidth<1200},groupsColors:function(){return this.groups.map((function(t){return t.color}))}},mounted:function(){var t=this;this.windowWidth=window.innerWidth,window.onresize=function(){window.innerWidth>=1200&&(t.isSidebarOpened=!1),t.windowWidth=window.innerWidth},d.$on("build-groups",(function(e){var n=e.groups,i=e.ungrouped;t.groups=Object.values(n),t.ungroupedPoints=Object.values(i)})),d.$on("add-point",(function(e){t.ungroupedPoints=Object.values(e)}))},methods:{toggleSidebar:function(){if(this.isSidebarOpened)return document.querySelector(".sidebar").classList.add("closed"),document.querySelector(".sidebar").classList.remove("opened"),void(this.isSidebarOpened=!1);document.querySelector(".sidebar").classList.add("opened"),document.querySelector(".sidebar").classList.remove("closed"),this.isSidebarOpened=!0},changePolygonColor:function(t){t.color=_.generateUniqueColor(this.groupsColors),t.polygon.setOptions({strokeColor:t.color,fillColor:t.color});var e,n=Object(l["a"])(t.points);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.marker.setIcon(k.changeShapeColor(t.color))}}catch(o){n.e(o)}finally{n.f()}},clearMap:function(){this.groups=[],this.ungroupedPoints=[],d.$emit("clear-map")},enterEditMode:function(t){this.$set(this.isEditingPointName,t.target.dataset.pointId,!0),this.$nextTick((function(){document.querySelector("input[data-point-id='".concat(t.target.dataset.pointId,"']")).focus()}))}}},D=E,T=(n("8d32"),Object($["a"])(D,u,c,!1,null,"b07e9bf0",null)),W=T.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"map"}})},q=[],N=(n("ac1f"),n("1276"),{name:"Map",data:function(){return{points:[],distances:{},groups:{},maxDistance:0,ungroupedPoints:{},id:0,pointDefaultColor:"#656668"}},computed:{map:function(){return new google.maps.Map(document.getElementById("map"),{zoom:8,center:{lat:51.1657,lng:10.4515}})},ruleDistance:function(){return this.maxDistance/4},groupsColors:function(){return Object.values(this.groups).map((function(t){return t.color}))},isToBuildGroups:function(){return this.points.length>8}},mounted:function(){var t=this;google.maps.event.addListener(this.map,"click",(function(e){t.addPoint(e.latLng,t.map).then((function(e){t.points.push(e),t.ungroupedPoints[e.id]=e,d.$emit("add-point",t.ungroupedPoints),t.isToBuildGroups&&(t.calculateDistances(),t.buildGroups(),t.drawGroupsPolygons(),d.$emit("build-groups",{groups:t.groups,ungrouped:t.ungroupedPoints}))}))}))},methods:{generateGroupId:function(){return this.id++},buildGroups:function(){for(var t in this.distances){var e=this.points[t.split(":")[0]],n=this.points[t.split(":")[1]];if(!(this.distances[t]>=this.ruleDistance||e.isInSameGroup(n)))if(e.isInGroup()||n.isInGroup())if(e.isInGroup()||!n.isInGroup())if(n.isInGroup()||!e.isInGroup()){var i=n.group.id,o=n.group.polygon;e.group.concatGroup(n.group),this.removePolygon(o),delete this.groups[i]}else e.group.addPoint(n),delete this.ungroupedPoints[n.id];else n.group.addPoint(e),delete this.ungroupedPoints[e.id];else{var r=new _(e,n,this.generateGroupId(),_.generateUniqueColor(this.groupsColors));delete this.ungroupedPoints[e.id],delete this.ungroupedPoints[n.id],this.groups[r.id]=r}}},removePolygon:function(t){t&&t.setMap(null)},drawGroupsPolygons:function(){for(var t in this.groups){var e=this.groups[t];this.removePolygon(e.polygon),e.drawPolygon(this.map)}},calculateDistances:function(){this.maxDistance=0;for(var t=0;t<this.points.length;t++)for(var e=this.points[t],n=e.marker.getPosition(),i=t+1;i<this.points.length;i++){var o=this.points[i],r=o.marker.getPosition(),s=Math.floor(google.maps.geometry.spherical.computeDistanceBetween(n,r)/1e3);this.distances[e.id+":"+o.id]=s,s>this.maxDistance&&(this.maxDistance=s)}},addPoint:function(t,e){var n=this;return new Promise((function(i){var o=k.generatePointId(n.points),r=new google.maps.Marker({position:t,icon:k.changeShapeColor(n.pointDefaultColor),map:e}),s=new k(o,r);i(s)}))}}}),F=N,U=(n("9999"),Object($["a"])(F,L,q,!1,null,"e44ecb24",null)),B=U.exports,z={name:"Layout",components:{Sidebar:W,GoogleMap:B},data:function(){return{isMap:!0}},mounted:function(){var t=this;d.$on("clear-map",(function(){t.rerenderMap()}))},methods:{rerenderMap:function(){var t=this;this.isMap=!1,this.$nextTick((function(){t.isMap=!0}))}}},A=z,J=(n("b88b"),Object($["a"])(A,s,a,!1,null,"328fd88c",null)),R=J.exports,H={name:"App",components:{Layout:R}},K=H,Q=(n("5c0b"),Object($["a"])(K,o,r,!1,null,null,null)),V=Q.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(V)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";n("9c0c")},"8d32":function(t,e,n){"use strict";n("aab9")},9999:function(t,e,n){"use strict";n("1c5c")},"9c0c":function(t,e,n){},aab9:function(t,e,n){},b88b:function(t,e,n){"use strict";n("bd0a")},bd0a:function(t,e,n){}});
//# sourceMappingURL=app.3a7dcf73.js.map